--- ip_fragment.c.old	Thu Apr 16 12:25:34 1998
+++ ip_fragment.c	Thu Apr 16 12:29:02 1998
@@ -375,7 +375,7 @@
 	fp = qp->fragments;
 	while(fp != NULL)
 	{
-		if (fp->len < 0 || count+fp->len > skb->len)
+		if (fp->len < 0 || fp->offset+qp->ihlen+fp->len > skb->len)
 		{
 			NETDEBUG(printk("Invalid fragment list: Fragment over size.\n"));
 			ip_free(qp);
